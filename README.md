# A ZDD-based Nagareru Solver and Generator

[Nagareru][Nagareru] is a pencil-and-paper puzzle.  
This program is a solver and generator for Nagareru based on ZDD.  



## Directories
- README.md: this file
- dataset:
  - handcrafted: Nagareru instances collected by crowling puzzle creator's blogs
  - generated: Nagareru instances generated by our generator
- source: source code of our solver and generator



## Usage

### Make

```bash
# Install TdZdd
$ git clone https://github.com/kunisura/TdZdd
$ export CPATH=$CPATH:$(pwd)/TdZdd-master/include
# Compile our program
$ git clone https://github.com/masakazu-ishihata/Nagareru
$ cd Nagareru/source
$ make
```

### Solve a Nagareru instance
```bash
$ ./nagareru --file example.txt --dump
////////////////////////////////////////
// Solving
////////////////////////////////////////
Problem File : example.txt
# board nodes : 89
# board edges : 118
# zdd nodes (non-reduced) : 66
# zdd nodes (reduced)     : 66
# solutions : 1
```

### Generate a Nagareru instance
```bash
$ ./nagareru --file random.txt --rand --width 10 --height 10
////////////////////////////////////////
// Random Generation
////////////////////////////////////////
Problem File : random.txt
CNF File     : random.cnf
Board Width  : 10
Board Height : 10
Init # Cells : 0
Seed         : 3316745319
# count call : 349
```



## Input file (Nagareru instance)

The input file should be in the [PUZ-PRE][pzv] format.  
The following is [example.txt][example.txt].  
You can solve this instance at [here][example].  

```
pzprv3
nagare
10
10
. . . . . . . . . .
. U . r r . . . . .
. . . . . . u . . .
. . . . R . . . . .
. U u . . . U . N .
. D . . . l . . . .
. . . N . . . N u .
. D . D . r . . . .
. . . . . . . N . .
. . . . . r . . . .
```


## Output files

### Solve a Nagareru instance
You may find the following files after `./nagareru --file example.txt --dump`.
* `example_graph.dot`: the dot file of the graph representation of the input file
* `example_graph.lst`: the edge list of the graph representation
* `example_solution_1.dot`: the dot file indicating the first solution.
* `example_zdd.dot`: the dot file representing the ZDD for all the solutions

### Generate a Nagareru instance
You may find the following files after `./nagareru --file random.txt --rand --width 10 --height 10`.
* `random.txt`: the PUZ-PRE format of the generated instance
* `random.cnf`: the CNF format of the generated instance
* `__temp__.lst`: a dump file (edge list)



## Links
* [Nagareru][Nagareru]
* [TdZdd][TdZdd]
* [PUZ-PRE][pzv]
* Puzzle Creator's Blogs we crawled to collect handcrafted instances
  * [チビスケ丸のパズル置き場][b1]
  * [黄色いパズル][b2]
  * [パズルに関する備忘録][b3]
  * [トクナキラのパズル工房][b4]
  * [かしゆさかなのパズル公園][b5]
  * [オーキシンのパズル保管庫][b6]
  * [pzdc][b7]



## Licensing
This program is free software provided under MIT.  
If you use the library, please cite the following paper:  
```
To be added
```


[Nagareru]:https://www.nikoli.co.jp/en/puzzles/nagareru/ "Nagareru"
[TdZdd]: https://github.com/kunisura/TdZdd "TdZdd"
[pzv]: http://pzv.jp/ "PUZ-PRE"
[example]: http://pzv.jp/p.html?nagare/10/10/k6a44k1g9f61c6a5b7c3g5c51b7a7a4k5g4d "example.txt"
[example.txt]: https://github.com/masakazu-ishihata/Nagareru/blob/master/source/example.txt "example.txt"
[b1]: http://tibisukemaru.blog.fc2.com/
[b2]: http://kiiroipazuru.blog.fc2.com/
[b3]: http://subarupuz.blog.fc2.com/
[b4]: http://puzzleblog542.blog.fc2.com/
[b5]: http://3141592653589797584.blog.fc2.com/
[b6]: http://auxinpuzzle.blog.fc2.com/
[b7]: http://pzdc.blog.fc2.com/
